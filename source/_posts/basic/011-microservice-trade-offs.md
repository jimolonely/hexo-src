---
title: 微服务权衡
tags:
  - microservice
p: basic/011-microservice-trade-offs
date: 2018-12-11 08:48:57
---

本文翻译自：[https://martinfowler.com/articles/microservice-trade-offs.html](https://martinfowler.com/articles/microservice-trade-offs.html)

许多开发团队发现[微服务架构](https://martinfowler.com/articles/microservices.html)风格是单片架构的优秀方法。 但其他团队发现它们是一种影响生产力的负担。 与任何架构一样，微服务带来成本和收益。 要做出明智的选择，您必须了解这些并将其应用于您的特定背景。

## 微服务提供的好处......

* 强大的模块边界：微服务增强了模块化结构，这对大型团队尤为重要。

* 独立部署：简单的服务更易于部署，并且由于它们是自治的，因此在出错时不太可能导致系统故障。

* 技术多样性：通过微服务，您可以混合使用多种语言，开发框架和数据存储技术。

## ......但需要付出代价

* 分布式：分布式系统更难编程，因为远程调用很慢并且始终存在故障风险。

* 最终的一致性：对于分布式系统来说，保持强一致性非常困难，这意味着每个人都必须管理最终的一致性。

* 运维复杂性：您需要一个成熟的运营团队来管理大量服务，这些服务需要定期重新部署。

# 强大的模块边界
微服务的第一大好处是强大的模块边界。 这是一个重要的好处，但却是一个奇怪的好处，因为从理论上讲，为什么微服务应该具有比单块更强的模块边界。

那么强大的模块边界是什么意思呢？ 我想大多数人都会同意将软件分成模块是很好的：大块的软件彼此分离。 你希望你的模块工作，这样如果我需要更改系统的一部分，大多数时候我只需要了解该系统的一小部分来进行更改，我可以很容易地找到这个小部分。 良好的模块化结构在任何程序中都很有用，但随着软件规模的扩大，它会变得越来越重要。 也许更重要的是，随着开发团队的规模不断扩大，它变得越来越重要。

微服务的倡导者很快就会引入[康微法则](http://www.thoughtworks.com/insights/blog/demystifying-conways-law)，即软件系统的结构反映了构建它的组织的通信结构。对于规模较大的团队，特别是如果这些团队位于不同的地点，重要的是构建软件以识别团队间通信将比团队内的团队通信更频繁，更正式。微服务允许每个团队使用这种通信模式来管理相对独立的单元。

正如我之前所说，单片系统没有理由不具备良好的模块化结构。 [1]但是很多人观察到它似乎很少见，因此[泥大球](http://www.laputan.org/mud/)是最常见的架构模式。事实上，对单一应用的共同命运的这种挫败感正在驱使一些团队进入微服务。与模块的分离是有效的，因为模块边界是模块之间引用的障碍。麻烦的是，使用单片系统，通常很容易绕过障碍物。这样做可以成为快速构建功能的一种有用的战术捷径，但是做得很广泛会破坏模块化结构并破坏团队的工作效率。将模块放入单独的服务使得边界更加牢固，使得找到这些癌症变通方法变得更加困难。

这种耦合的一个重要方面是持久化数据。 微服务的一个关键特性是[分散数据管理](https://martinfowler.com/microservices.html#DecentralizedDataManagement)，它表示每个服务都管理自己的数据库，任何其他服务都必须通过服务的API才能获得它。 这消除了[集成数据库](https://martinfowler.com/bliki/IntegrationDatabase.html)，这是大型系统中令人讨厌的耦合的主要来源。

重要的是要强调，单片系统完全可能具有牢固的模块边界，但它需要规范。 同样地，你可以得到一个微型泥球，但它需要更多的努力，而且是错的。 我看待使用微服务的方式增加了你获得更好的模块化的可能性。 如果你对你的团队的纪律充满信心，那么这可能会消除这种优势，但随着团队的发展，它越来越难以保持纪律，就像维护模块边界变得更加重要一样。

如果你没有正确的界限，这种优势将成为一个障碍。这是[单片优先](https://martinfowler.com/bliki/MonolithFirst.html)策略的两个主要原因之一，以及为什么即使那些[更倾向于使用微服务运行](https://martinfowler.com/articles/dont-start-monolith.html)的人也会强调，只有通过一个易于理解的域才能这样做。

但是我还没有完成关于这一点的警告。在时间过去之后，您才能真正了解系统维护模块化的程度。因此，一旦我们看到微服务系统已经存在至少几年，我们就能真正评估微服务是否会带来更好的模块化。此外，早期采用者往往更有天赋，因此在我们评估普通团队编写的微服务系统的模块化优势之前还会有进一步的延迟。即使在那时，我们也必须接受普通团队编写普通软件，因此我们不必将结果与顶级团队进行比较，而是将所得到的软件与单片体系结构下的软件进行比较 - 这是一个棘手的反事实评估。

我现在所能继续的只是我从我认识的人那里听到的早期证据。他们的判断是维护模块要容易得多。

一个案例研究特别有趣。团队做出了错误的选择，在一个系统上使用微服务，这个系统不够复杂，无法覆盖[Microservice Premium](https://martinfowler.com/bliki/MicroservicePremium.html)。该项目陷入困境，需要获救，因此更多的人被投入到项目中。在这一点上，微服务架构变得有用，因为系统能够吸收开发人员的快速涌入，并且团队能够比单片系统下更容易地利用更大团队的人数数量。因此，该项目加速到比单块预期更高的生产力，使团队能够赶上。结果仍然是一个净负值，因为软件花费的工作时间比它们使用单​​块时所花费的工作时间更多，但微服务架构确实支持提升。




